[gd_scene load_steps=7 format=3 uid="uid://f1vvoqdrimh7"]

[ext_resource type="Texture2D" uid="uid://3660ojhvsyqn" path="res://icon.svg" id="1_1v6j1"]
[ext_resource type="Texture2D" uid="uid://cey74pidop5xu" path="res://circle 128p.png" id="1_yikqb"]

[sub_resource type="GDScript" id="GDScript_eu11m"]
resource_name = "main"
script/source = "extends Node2D

func _ready():
	var config: ConfigFile = ConfigFile.new()
	var window: Window = get_window()
	if config.load(\"res://config.cfg\") == OK:
		window.position = config.get_value(\"window\",\"position\")
#		window.size = config.get_value(\"window\",\"size\")
		print( \"config loaded\" )
"

[sub_resource type="GDScript" id="GDScript_6sbef"]
resource_name = "progress"
script/source = "extends TextureProgressBar
var time : Dictionary
@export var colors : PackedColorArray
@onready var steps: int = colors.size() - 1

func _process(_delta):
	time = Time.get_datetime_dict_from_system()
	value = time.minute * 60 + time.second
	
	var t: float = value / max_value
	var delta: float = 1.0 / steps
	var index: int = int( t / delta )
	var local_t: float = fmod( t, delta ) / delta
	print(local_t)

	tint_progress = colors[index].lerp( colors[index+1], local_t )
#	print(Time.get_ticks_msec())
#	print(time.second)
"

[sub_resource type="GDScript" id="GDScript_xqv6w"]
resource_name = "drag_button"
script/source = "extends Button
var drag_offset : Vector2i


func _ready():
	set_process_input(false)


func _input(event):
	if not event is InputEventMouseMotion: return
	get_window().position = DisplayServer.mouse_get_position() - drag_offset


func _on_button_down():
	print(\"drag start\")
	set_process_input(true)
	Engine.max_fps = 60
	drag_offset = DisplayServer.mouse_get_position() - get_window().position


func _on_button_up():
	print(\"drag end\")
	set_process_input(false)
	Engine.max_fps = 1
	var config = ConfigFile.new()
	config.set_value( \"window\", \"position\", get_window().position )
	config.save(\"config.cfg\")
#	ProjectSettings.set_setting( 'display/window/size/initial_position', get_window().position )
#	ProjectSettings.save_custom('override.cfg')
"

[sub_resource type="GDScript" id="GDScript_ymbr8"]
resource_name = "resize_button"
script/source = "extends Button
#var drag_offset : Vector2i
var is_resizing : bool


func _input(event):
	if not is_resizing: return
	if not event is InputEventMouseMotion: return
#	get_window().position = DisplayServer.mouse_get_position() - drag_offset


func _on_button_down():
	print(\"resizing\")
	is_resizing = true
	Engine.max_fps = 60
#	drag_offset = DisplayServer.mouse_get_position() - get_window().position


func _on_button_up():
	print(\"resizing end\")
	Engine.max_fps = 1
#	ProjectSettings.set_setting( 'display/window/size/initial_position', get_window().position )
#	ProjectSettings.save()
	is_resizing = false
"

[node name="Node2D" type="Node2D"]
script = SubResource("GDScript_eu11m")

[node name="MinutesProgress" type="TextureProgressBar" parent="."]
offset_right = 283.0
offset_bottom = 247.0
max_value = 3600.0
fill_mode = 4
texture_under = ExtResource("1_yikqb")
texture_progress = ExtResource("1_yikqb")
tint_under = Color(0.180392, 0.180392, 0.180392, 1)
script = SubResource("GDScript_6sbef")
colors = PackedColorArray(1, 0, 1, 0.509804, 0, 0, 1, 0.780392, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 0, 0, 1)

[node name="DragButton" type="Button" parent="."]
modulate = Color(1, 1, 1, 0)
offset_right = 128.0
offset_bottom = 128.0
script = SubResource("GDScript_xqv6w")

[node name="ResizeButton" type="Button" parent="."]
offset_left = 111.0
offset_top = 111.0
offset_right = 128.0
offset_bottom = 128.0
icon = ExtResource("1_1v6j1")
expand_icon = true
script = SubResource("GDScript_ymbr8")

[connection signal="button_down" from="DragButton" to="DragButton" method="_on_button_down"]
[connection signal="button_up" from="DragButton" to="DragButton" method="_on_button_up"]
[connection signal="button_down" from="ResizeButton" to="ResizeButton" method="_on_button_down"]
[connection signal="button_up" from="ResizeButton" to="ResizeButton" method="_on_button_up"]
